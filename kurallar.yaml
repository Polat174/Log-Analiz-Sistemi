rules:
  # --- KRİTİK GÜVENLİK KURALLARI (Senin İstediklerin) ---
  - name: "SSH Guvenlik Hatasi"
    # Hem "Failed password" hem de dosyadaki "authentication failure"ı yakalar
    pattern: "Failed password|authentication failure|illegal user"
    severity: "High"
    description: "SSH uzerinden hatali giris denemesi"

  - name: "Root Yetki Denemesi"
    pattern: "root"
    severity: "Critical"
    description: "Root kullanicisi ile islem yapildi"

  - name: "Nginx/Web Hatasi"
    pattern: " (4[0-9]{2}|5[0-9]{2}) "
    severity: "Medium"
    description: "Web sunucusu hata kodu"

  # --- GENEL YAKALAYICILAR (Sayıyı Yükseltenler) ---
  - name: "Sistem Oturumu"
    pattern: "session opened|session closed"
    severity: "Low"
    description: "Kullanici oturum acip kapatti (su/sudo)"

  - name: "FTP Baglantisi"
    pattern: "ftpd.*connection"
    severity: "Medium"
    description: "FTP sunucusuna baglanti"

  - name: "Genel Hata Kelimeleri"
    # Loglarda geçen "error", "fail", "warning" kelimelerinin hepsini toplar
    pattern: "error|fail|warning|denied|refused"
    severity: "Low"
    description: "Genel hata mesajlari"
